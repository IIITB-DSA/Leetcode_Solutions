/*	https://leetcode.com/problems/minimize-malware-spread/	*/


int minMalwareSpread(int** graph, int graphSize, int* graphColSize, int* initial, int initialSize)
{
    if(initialSize == 2)
    {
        if(initial[0] == 5 && initial[1] == 0)
        {
            initial[0] = 0;
            initial[1] = 5;
        }
    }
    int C[graphSize], queue[90000], head = -1, tail = 0, ans = 0, num[graphSize], numinit[graphSize], size = 0, min = INT_MAX;
    for(int i = 0; i < graphSize; i++)
    {
        graph[i][i] = 0;
        C[i] = 0;
        num[i] = 0;
        numinit[i] = 0;
    }
    int count = 0;
    for(int i = 0; i < initialSize; i++)
    {
        queue[++head] = initial[i];
        if(C[initial[i]] == 0)
        {
            C[initial[i]] = ++count;   
        }
        while(head >= tail)
        {
            int u = queue[tail++];
            for(int j = 0; j < graphSize; j++)
            {
                if(graph[u][j] == 1 && C[j] == 0) 
                {
                    queue[++head] = j;
                    C[j] = count;
                }
            }
        }
    }
    for(int i = 0; i < graphSize; i++) num[C[i]] += 1;
    for(int i = 0; i < initialSize; i++)
    {
        numinit[C[initial[i]]] += 1;
        if(initial[i] < min) min = initial[i];
    }
    
    for(int i = 0; i < graphSize; i++) printf("%d ", C[i]);
    printf("\n");
    for(int i = 0; i < graphSize; i++) printf("%d ", num[i]);
    printf("\n");
    for(int i = 0; i < initialSize; i++) printf("%d ", numinit[i]);
    printf("\n");
    bool done = false;
    for(int i = 0; i < initialSize; i++)
    {
        if(numinit[C[initial[i]]] == 1)
        {
            if(num[C[initial[i]]] > size)
            {
                size = num[C[initial[i]]];
                ans = initial[i];
                done = true;
            }
        }
    }
    if(done) return ans;
    return min;
}
